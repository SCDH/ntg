

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Scripts &mdash; NTG 0.1.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="_static/my_theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Database Structure" href="database.html" />
    <link rel="prev" title="API Server" href="server_dev.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> NTG
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#web-application">Web Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#preparing-the-database-for-the-cbgm">Preparing the Database for the CBGM</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#applying-the-cbgm">Applying the CBGM</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#updating-the-apparatus">Updating the Apparatus</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#links">Links</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install-linux.html">Installation on Linux</a><ul>
<li class="toctree-l3"><a class="reference internal" href="install-linux.html#install-prerequisites">Install Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="install-linux.html#database-access">Database Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="install-linux.html#application-server">Application server</a></li>
<li class="toctree-l3"><a class="reference internal" href="install-linux.html#cbgm">CBGM</a></li>
<li class="toctree-l3"><a class="reference internal" href="install-linux.html#run-server">Run Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="install-linux.html#build-and-run-client">Build and run client</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="install-docker.html">Installation with Docker</a><ul>
<li class="toctree-l3"><a class="reference internal" href="install-docker.html#install">Install</a></li>
<li class="toctree-l3"><a class="reference internal" href="install-docker.html#running-the-web-application">Running the web application</a></li>
<li class="toctree-l3"><a class="reference internal" href="install-docker.html#running-the-cbgm">Running the CBGM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user.html">User Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="client_user.html">Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="server_user.html">Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="server_user.html#server-main-py">server/__main__.py</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="scripts_user.html">Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="scripts_user.html#scripts-cceh-import-py">scripts/cceh/import.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="scripts_user.html#scripts-cceh-prepare-py">scripts/cceh/prepare.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="scripts_user.html#scripts-cceh-cbgm-py">scripts/cceh/cbgm.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="scripts_user.html#scripts-cceh-save-edits-py">scripts/cceh/save_edits.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="scripts_user.html#scripts-cceh-load-edits-py">scripts/cceh/load_edits.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="scripts_user.html#scripts-cceh-mk-users-py">scripts/cceh/mk_users.py</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="developer.html">Developer Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="domain.html">Introduction to the Problem Domain (German)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="domain.html#das-neue-testament">Das Neue Testament</a></li>
<li class="toctree-l3"><a class="reference internal" href="domain.html#editionen">Editionen</a></li>
<li class="toctree-l3"><a class="reference internal" href="domain.html#die-textzeugen">Die Textzeugen</a></li>
<li class="toctree-l3"><a class="reference internal" href="domain.html#textformen-texttypen">Textformen (Texttypen)</a></li>
<li class="toctree-l3"><a class="reference internal" href="domain.html#textkritik">Textkritik</a></li>
<li class="toctree-l3"><a class="reference internal" href="domain.html#terminologie">Terminologie</a></li>
<li class="toctree-l3"><a class="reference internal" href="domain.html#literatur">Literatur</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="client_dev.html">Web Client</a><ul>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-app">client/app</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-apparatus">client/apparatus</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-coherence">client/coherence</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-comparison">client/comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-comparison-details-table">client/comparison_details_table</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-comparison-table">client/comparison_table</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-d3-chord-layout">client/d3_chord_layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-d3-common">client/d3_common</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-d3-stemma-layout">client/d3_stemma_layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-find-relatives">client/find_relatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-flash-messages">client/flash_messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-leitzeile">client/leitzeile</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-local-stemma">client/local_stemma</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-notes">client/notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-notes-list">client/notes_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-optimal-substemma">client/optimal_substemma</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-optimal-substemma-details">client/optimal_substemma_details</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-page-header">client/page_header</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-project-list">client/project_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-relatives-metrics">client/relatives_metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-relatives-table">client/relatives_table</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-set-cover">client/set_cover</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-table-sort-mixin">client/table_sort_mixin</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-table-toggle-mixin">client/table_toggle_mixin</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-textflow">client/textflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-tools">client/tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-widgets-autocomplete">client/widgets/autocomplete</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-widgets-button-group">client/widgets/button_group</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-widgets-card">client/widgets/card</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-widgets-card-caption">client/widgets/card_caption</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-widgets-connectivity">client/widgets/connectivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-widgets-context-menu">client/widgets/context_menu</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-widgets-dropdown-mixin">client/widgets/dropdown_mixin</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-widgets-labezator">client/widgets/labezator</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-widgets-navigator">client/widgets/navigator</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-widgets-range">client/widgets/range</a></li>
<li class="toctree-l3"><a class="reference internal" href="client_dev.html#client-widgets-toolbar">client/widgets/toolbar</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="server_dev.html">API Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="server_dev.html#module-server">server</a></li>
<li class="toctree-l3"><a class="reference internal" href="server_dev.html#module-server.main">server.main</a></li>
<li class="toctree-l3"><a class="reference internal" href="server_dev.html#module-server.textflow">server.textflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="server_dev.html#module-server.comparison">server.comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="server_dev.html#module-server.set_cover">server.set_cover</a></li>
<li class="toctree-l3"><a class="reference internal" href="server_dev.html#module-server.editor">server.editor</a></li>
<li class="toctree-l3"><a class="reference internal" href="server_dev.html#module-server.login">server.login</a></li>
<li class="toctree-l3"><a class="reference internal" href="server_dev.html#module-server.helpers">server.helpers</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-scripts.cceh.import">scripts.cceh.import</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-scripts.cceh.prepare">scripts.cceh.prepare</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-scripts.cceh.cbgm">scripts.cceh.cbgm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-scripts.cceh.save_edits">scripts.cceh.save_edits</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-scripts.cceh.load_edits">scripts.cceh.load_edits</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-scripts.cceh.mk_users">scripts.cceh.mk_users</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="database.html">Database Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="database.html#cbgm-database">CBGM Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="database.html#source-database">Source Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="database.html#literature">Literature</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ntg_common.html">Various Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ntg_common.html#module-ntg_common.db_tools">ntg_common.db_tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="ntg_common.html#module-ntg_common.tools">ntg_common.tools</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NTG</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="developer.html">Developer Manual</a> &raquo;</li>
        
      <li>Scripts</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/scripts_dev.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-scripts"></span><div class="section" id="scripts">
<h1>Scripts<a class="headerlink" href="#scripts" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-scripts.cceh.import">
<span id="scripts-cceh-import"></span><h2>scripts.cceh.import<a class="headerlink" href="#module-scripts.cceh.import" title="Permalink to this headline">¶</a></h2>
<p>Import databases from mysql.</p>
<p>This script initializes the postgres database and then imports data from one or
more mysql databases.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure to follow the steps in <a class="reference internal" href="install-linux.html#database-access"><span class="std std-ref">Database Access</span></a> first.</p>
</div>
<p>The source databases are:</p>
<ol class="arabic simple">
<li><p>a database containing the apparatus of the <em>Editio Critica Maior</em>
publication (ECM).</p></li>
<li><p>a database containing the editorial decisions regarding the priority of the
readings (VarGen).</p></li>
<li><p>a database containing the “Leitzeile” (Nestle).</p></li>
</ol>
<p>The source tables for Acts are partitioned into 28 chapters.  This is a
historical incident: The software used when the CBGM was first implemented could
not handle big tables.  The import script is able to join partitioned tables.</p>
<p>After running this script should run the <a class="reference internal" href="scripts_user.html#prepare-py"><span class="std std-ref">scripts/cceh/prepare.py</span></a> script.</p>
<dl class="function">
<dt id="scripts.cceh.import.concat_tables_fdw">
<code class="sig-name descname">concat_tables_fdw</code><span class="sig-paren">(</span><em class="sig-param">conn</em>, <em class="sig-param">meta</em>, <em class="sig-param">dest_table</em>, <em class="sig-param">fdw</em>, <em class="sig-param">table_mask</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.import.concat_tables_fdw" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate multiple tables into one.</p>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.import.copy_table_fdw">
<code class="sig-name descname">copy_table_fdw</code><span class="sig-paren">(</span><em class="sig-param">conn</em>, <em class="sig-param">dest_table</em>, <em class="sig-param">fdw</em>, <em class="sig-param">source_table</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.import.copy_table_fdw" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy a table.</p>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.import.import_att_fdw">
<code class="sig-name descname">import_att_fdw</code><span class="sig-paren">(</span><em class="sig-param">dbsrc</em>, <em class="sig-param">dbdest</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.import.import_att_fdw" title="Permalink to this definition">¶</a></dt>
<dd><p>Import att and lac tables from mysql.</p>
<p>Import the (28 * 2) mysql tables to 2 tables in the postgres database.</p>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.import.import_genealogical_fdw">
<code class="sig-name descname">import_genealogical_fdw</code><span class="sig-paren">(</span><em class="sig-param">dbsrc</em>, <em class="sig-param">dbdest</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.import.import_genealogical_fdw" title="Permalink to this definition">¶</a></dt>
<dd><p>Import genealogical tables from mysql.</p>
<p>Import the (28 * 3) mysql tables to 3 tables in the postgres database.</p>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.import.import_nestle_fdw">
<code class="sig-name descname">import_nestle_fdw</code><span class="sig-paren">(</span><em class="sig-param">dbsrc</em>, <em class="sig-param">dbdest</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.import.import_nestle_fdw" title="Permalink to this definition">¶</a></dt>
<dd><p>Import Nestle table from mysql.</p>
</dd></dl>

</div>
<div class="section" id="module-scripts.cceh.prepare">
<span id="scripts-cceh-prepare"></span><h2>scripts.cceh.prepare<a class="headerlink" href="#module-scripts.cceh.prepare" title="Permalink to this headline">¶</a></h2>
<p>Initialize a CBGM database.</p>
<p>This script converts the databases structure used in the production of the <em>ECM</em>
into a database structure suitable for doing CBGM. It</p>
<ul class="simple">
<li><p>normalizes the databases,</p></li>
<li><p>removes manuscripts, passages and readings irrelevant to the CBGM,</p></li>
<li><p>builds a positive apparatus from the negative apparatus,</p></li>
<li><p>reconstructs the <a class="reference internal" href="domain.html#mt"><span class="std std-ref">Majority Text</span></a>.</p></li>
</ul>
<p>Database normalization is the usual process of restructuring your tables so they
don’t contain redundant data.</p>
<p>The database must then be purged from all readings that are relevant for the
<em>ECM</em> and the <em>Nestle-Aland</em> only, but not for the CBGM, eg. all passages
without variants (about 2/3 of the New Testament), all corrections except those
by the first hand, and readings that are clearly orthographic errors or
differing only by orthgographic convention.</p>
<p>The script then <a class="reference internal" href="#transform-positive"><span class="std std-ref">transforms</span></a> the negative apparatus into a
positive apparatus, that is, an apparatus that is defined for all manuscripts at
all passages.</p>
<p>Finally the script reconstructs the <a class="reference internal" href="domain.html#mt"><span class="std std-ref">Majority Text</span></a>.</p>
<p>After running this script you should run the <a class="reference internal" href="scripts_user.html#cbgm-py"><span class="std std-ref">scripts/cceh/cbgm.py</span></a> script.</p>
<blockquote>
<div><p>Ausgangspunkt ist der Apparat mit allen für die Druckfassung notwendigen
Informationen.  Diese Datenbasis muss für die CBGM bearbeitet werden.  Die
Ausgangsdaten stellen einen negativen Apparat dar, d.h. die griechischen
handschriftlichen Zeugen, die mit dem rekonstruierten Ausgangstext
übereinstimmen, werden nicht ausdrücklich aufgelistet.  Aufgelistet werden
alle Zeugen, die von diesem Text abweichen bzw. Korrekturen oder
Alternativlesarten haben.  Ziel ist es, einen positiven Apparat zu erhalten.
Wir benötigen einen Datensatz pro griechischem handschriftlichen Zeugen
erster Hand und variierten Stelle (einschließlich der Lücken).  D.h. für jede
variierte Stelle liegt die explizite Information vor, ob die Handschrift dem
Ausgangstext folgt, einen anderen Text oder gar keinen Text hat, weil
z.B. die Seite beschädigt ist.  Korrekturen oder Alternativlesarten werden
für die CBGM ignoriert.</p>
<p class="attribution">—ArbeitsablaufCBGMApg_Db.docx</p>
</div></blockquote>
<dl class="function">
<dt id="scripts.cceh.prepare.build_MT_text">
<code class="sig-name descname">build_MT_text</code><span class="sig-paren">(</span><em class="sig-param">dba</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.prepare.build_MT_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstruct the Majority Text</p>
<p>Build a virtual manuscript that reconstructs the <a class="reference internal" href="domain.html#mt"><span class="std std-ref">Majority Text</span></a>.</p>
<blockquote>
<div><p id="mt-rules">Im Laufe der Textgeschichte hat sich eine Textform durchgesetzt, der
sogenannte Mehrheitstext, der auch Byzantinischer Text genannt wird.
Diese Textform wird exemplarisch durch die sieben Handschriften 1, 18,
35, 330, 398, 424 und 1241 repräsentiert.  Für jede variierte Stelle
wird nun gezählt und festgehalten, wieviele dieser sieben Handschriften
bei einer Lesart vertreten sind.  Eine Lesart gilt als Mehrheitslesart,
wenn sie</p>
<ol class="loweralpha simple">
<li><p>von mindestens sechs der oben genannten repräsentativen Handschriften
bezeugt wird und höchstens eine Handschrift abweicht, oder</p></li>
<li><p>von fünf Repräsentanten bezeugt wird und zwei mit unterschiedlichen
Lesarten abweichen.</p></li>
</ol>
<p class="attribution">—PreCo/PreCoActs/ActsMT2.pl</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.prepare.copy_genealogical">
<code class="sig-name descname">copy_genealogical</code><span class="sig-paren">(</span><em class="sig-param">dbdest</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.prepare.copy_genealogical" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy / fix genealogical data</p>
<blockquote>
<div><p>kopiert die Daten aus ECM_Acts_CBGM nach VarGenAtt_Act, zur weiteren
Bearbeitung im Stemma-Editor</p>
<p class="attribution">—VGA/Att2CBGMPh3.pl</p>
</div></blockquote>
<blockquote>
<div><p>Kopiert die genealogischen Informationen von einer Phase zur nächsten.</p>
<p>Splitts müssen nur dort übertragen werden, wo sich der Apparat nicht
geändert hat.  Hat sich der Apparat geändert, d.h. gibt es in der neuen
Phase für eine Adresse keine Entsprechung in der vorhergehenden Phase,
so werden die Defaultwerte eingetragen.  Zuerst muss festgestellt
werden, wo Splitts oder Zusammenlegungen stattgefunden haben.  Dann
werden diese Lesarten gelöscht und aus der vorhergehenden Phase kopiert.</p>
<p>Stellen mit geänderter Leitzeile werden zunächst einfach übergangen.</p>
<p>Defaultwerte eintragen, wenn eine variierte Stelle mit gleicher
numerischer Adresse mehr Lesarten als in der vorhergehenden Phase hat,
die nicht nur versionell bezeugt sind.</p>
<p class="attribution">—VGA/PortCBGMInfoPh3.pl</p>
</div></blockquote>
<p>VarGenAtt_ActPh2 -&gt; VarGenAtt_ActPh3</p>
<ol class="arabic simple">
<li><p>copy entries from att with default values (every other labez depends on
a) (done in the last step)</p></li>
<li><p>overwrite with values from locstemed (done in this step)</p></li>
</ol>
<p>FIXME: do we really need step 1? To provide the new passages if the
apparatus changed? At least it doesn’t do any damage because there should be
no passages in att that are not in locstemed also.</p>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.prepare.copy_nestle">
<code class="sig-name descname">copy_nestle</code><span class="sig-paren">(</span><em class="sig-param">dbdest</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.prepare.copy_nestle" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a working copy of the Nestle table.</p>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.prepare.copy_table">
<code class="sig-name descname">copy_table</code><span class="sig-paren">(</span><em class="sig-param">conn</em>, <em class="sig-param">source_table</em>, <em class="sig-param">dest_table</em>, <em class="sig-param">where=''</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.prepare.copy_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a copy of a table.</p>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.prepare.delete_corrector_hands">
<code class="sig-name descname">delete_corrector_hands</code><span class="sig-paren">(</span><em class="sig-param">dba</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.prepare.delete_corrector_hands" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete later hands</p>
<p>Delete all corrections except those by the first hand.</p>
<blockquote>
<div><p>Lesarten löschen, die nicht von der ersten Hand stammen.  […]
Ausnahme: Bei Selbstkorrekturen wird die <em>-Lesart gelöscht und die
C</em>-Lesart beibehalten.</p>
<p class="attribution">—prepare4cbgm_6.py</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.prepare.delete_invariant_passages">
<code class="sig-name descname">delete_invariant_passages</code><span class="sig-paren">(</span><em class="sig-param">dba</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.prepare.delete_invariant_passages" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete invariant passages</p>
<p>A passage is invariant if all defined manuscripts offer the same
(regularized) text.  Invariant passages are irrelevant to the CBGM.</p>
<blockquote>
<div><p>Stellen löschen, an denen nur eine oder mehrere f- oder o-Lesarten vom
A-Text abweichen. Hier gibt es also keine Variante.</p>
<p>Nicht löschen, wenn an dieser variierten Stelle eine Variante ‘b’ - ‘y’
erscheint.</p>
<p>Änderung 2014-12-16: Act 28,29/22 gehört zu einem Fehlvers.  Dort gibt
es u.U. keine Variante neben b, sondern nur ein Orthographicum.  Wir
suchen also nicht mehr nach einer Variante ‘b’ bis ‘y’, sondern zählen
die Varianten.  Liefert getReadings nur 1 zurück, gibt es keine
Varianten.</p>
<p class="attribution">—prepare4cbgm_5.py</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.prepare.delete_lectionaries">
<code class="sig-name descname">delete_lectionaries</code><span class="sig-paren">(</span><em class="sig-param">dba</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.prepare.delete_lectionaries" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete secondary lectionary readings</p>
<p>Also delete lectionary readings except L1.</p>
<blockquote>
<div><p>Bei mehreren Lektionslesarten gilt die L1-Lesart.</p>
<p class="attribution">—prepare4cbgm_6.py</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.prepare.fill_apparatus_table">
<code class="sig-name descname">fill_apparatus_table</code><span class="sig-paren">(</span><em class="sig-param">dba</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.prepare.fill_apparatus_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill the apparatus table with a positive apparatus.</p>
<p id="transform-positive">The <a class="reference internal" href="database.html#ntg_common.db.Att" title="ntg_common.db.Att"><code class="xref py py-class docutils literal notranslate"><span class="pre">Att</span></code></a> table contains a negative apparatus.  A
negative apparatus contains the text of the archetypus (manuscript ‘A’), but
other manuscripts only when they offer a different reading.</p>
<p>The <a class="reference internal" href="database.html#ntg_common.db.Apparatus" title="ntg_common.db.Apparatus"><code class="xref py py-class docutils literal notranslate"><span class="pre">Apparatus</span></code></a> table contains a positive apparatus.
A positive apparatus contains the text of all manuscripts at all passages.</p>
<p>Steps to transform the negative apparatus into a positive apparatus</p>
<ol class="arabic simple">
<li><p>Set all passages in all manuscripts to the reading ‘a’.</p></li>
<li><p>Overwrite all Fehlverse in all manuscripts with the reading ‘zu’.</p></li>
<li><p>Unroll the <a class="reference internal" href="database.html#ntg_common.db.Lac" title="ntg_common.db.Lac"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lac</span></code></a> table.  Entries in Lac table may
span multiple passages.  Overwrite every passage that is inside a lacuna
with ‘zz’.</p></li>
<li><p>Overwrite with the readings from the negative apparatus in the
<a class="reference internal" href="database.html#ntg_common.db.Att" title="ntg_common.db.Att"><code class="xref py py-class docutils literal notranslate"><span class="pre">Att</span></code></a> table, if there is such a reading.</p></li>
</ol>
<p>N.B. Readings in the negative apparatus do sometimes override lacunae.</p>
<p>In the result we have one entry in the apparatus for every manuscript and
every passage.</p>
<p>See paper: <em>Arbeitsablauf CBGM auf Datenbankebene, I. Vorbereitung der
Datenbasis für CBGM</em></p>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.prepare.fill_manuscripts_table">
<code class="sig-name descname">fill_manuscripts_table</code><span class="sig-paren">(</span><em class="sig-param">dba</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.prepare.fill_manuscripts_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the Manuscripts and Ms_Ranges tables.</p>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.prepare.fill_ms_cliques_table">
<code class="sig-name descname">fill_ms_cliques_table</code><span class="sig-paren">(</span><em class="sig-param">dba</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.prepare.fill_ms_cliques_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the ms_cliques table.</p>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.prepare.fill_passages_table">
<code class="sig-name descname">fill_passages_table</code><span class="sig-paren">(</span><em class="sig-param">dba</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.prepare.fill_passages_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the Passages table.</p>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.prepare.fill_readings_table">
<code class="sig-name descname">fill_readings_table</code><span class="sig-paren">(</span><em class="sig-param">dba</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.prepare.fill_readings_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the readings table.</p>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.prepare.mark_invariant_passages">
<code class="sig-name descname">mark_invariant_passages</code><span class="sig-paren">(</span><em class="sig-param">dba</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.prepare.mark_invariant_passages" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark invariant passages</p>
<p>A passage is invariant if all defined manuscripts offer the same
(regularized) text.  Invariant passages are irrelevant to the CBGM.</p>
<p>We need to display the “Leitzeile”, so we cannot simply delete these
passages.  We mark them as invariant instead.</p>
<p>FIXME: this is moot since we get the Leitzeile from a different database
altogether.  OTOH <a class="reference internal" href="database.html#ntg_common.db.Att" title="ntg_common.db.Att"><code class="xref py py-class docutils literal notranslate"><span class="pre">Att</span></code></a> never contained all passages
anyway, so it was impossible to extract the Leitzeile out of it.</p>
<blockquote>
<div><p>Stellen löschen, an denen nur eine oder mehrere f- oder o-Lesarten
vom A-Text abweichen. Hier gibt es also keine Variante.</p>
<p>Nicht löschen, wenn an dieser variierten Stelle eine Variante ‘b’
- ‘y’ erscheint.</p>
<p>Änderung 2014-12-16: Act 28,29/22 gehört zu einem Fehlvers.  Dort
gibt es u.U. keine Variante neben b, sondern nur ein
Orthographicum.  Wir suchen also nicht mehr nach einer Variante
‘b’ bis ‘y’, sondern zählen die Varianten.  Liefert getReadings
nur 1 zurück, gibt es keine Varianten.</p>
<p class="attribution">—prepare4cbgm_5.py</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.prepare.process_commentaries">
<code class="sig-name descname">process_commentaries</code><span class="sig-paren">(</span><em class="sig-param">dba</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.prepare.process_commentaries" title="Permalink to this definition">¶</a></dt>
<dd><p>Process commentaries</p>
<p>Commentaries often contain more than one reading of the same passage.  If
those readings are different we must degrade them to uncertain status.</p>
<p>Also promote the manuscript to ‘normal’ status by stripping the commentary
suffix (in re_comm) from the hs.</p>
<blockquote>
<div><p>20. Mai 2015.  Commentary manuscripts like 307 cannot be treated like
lectionaries where we choose the first text.  If a T1 or T2 reading is
found they have to be deleted.  A new zw reading is created containing
the old readings as suffix.</p>
<p>This has to be done as long as both witnesses are present.</p>
<p>If the counterpart of one entry belongs to the list of lacunae the
witness will be treated as normal witness. The T notation can be
deleted.</p>
<p class="attribution">—prepare4cbgm_5b.py</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.prepare.process_sigla">
<code class="sig-name descname">process_sigla</code><span class="sig-paren">(</span><em class="sig-param">dba</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.prepare.process_sigla" title="Permalink to this definition">¶</a></dt>
<dd><p>Process Sigla</p>
<p>Rewrite the manuscript sigla (hs) and delete all suffixes.</p>
<blockquote>
<div><p>Handschriften, die mit einem “V” für videtur gekennzeichnet sind, werden
ebenso wie alle anderen behandelt.  Das “V” kann also getilgt werden.
Die Eintragungen für “ursprünglich (*)” und “C*” werden ebenfalls
gelöscht.  Schließlich auch die Zusätze zur Handschriftennummer wie
“T1”.  Diese Eintragungen werden (bisher) einfach an die
Handschriftenbezeichnung angehängt.</p>
<p>Der Eintrag ‘videtur’, gekennzeichnet durch ein ‘V’ hinter der
Handschriftennummer, spielt für die CBGM keine Rolle.  Ein eventuell
vorhandenes ‘V’ muss getilgt werden.  Gleiches gilt für die Einträge ‘*’
und ‘C*’.</p>
<p class="attribution">—prepare4cbgm_6b.py</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="scripts.cceh.prepare.unroll_zw">
<code class="sig-name descname">unroll_zw</code><span class="sig-paren">(</span><em class="sig-param">dba</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.prepare.unroll_zw" title="Permalink to this definition">¶</a></dt>
<dd><p>Unroll ‘zw’ entries</p>
<p>When a reading cannot be classified under a labez with absolute certainty,
the apparatus sets the labez to ‘zw’ (zweifelhaft, dubious) and offers a
list of candidate labez in labezsuf.  This list of candidates in labezsuf
has to be normalized into multiple table records.</p>
<p>If <span class="math notranslate nohighlight">\(N &gt; 1\)</span> labez candidates exists, the certainty of the unrolled
records will be set to <span class="math notranslate nohighlight">\(1 / N\)</span>.</p>
<p>But if all candidate labez differ only in their errata or ortographica
suffix, as in ‘a/ao1/ao2’ or ‘b/b_f’ then we will output only one record
with a certainty of 1.0.</p>
<p>Caveat: in Mark, labezsuf may contain a list of candidate labez even if
labez is not ‘zw’.  This is why we no longer look for ‘zw’ in labez but for
‘/’ in labezsuf.</p>
<blockquote>
<div><p>zw-Lesarten der übergeordneten Variante zuordnen, wenn ausschliesslich
verschiedene Lesarten derselben Variante infrage kommen (z.B. zw a/ao
oder b/bo_f).  In diesen Fällen tritt die Buchstabenkennung der
übergeordneten Variante in labez an die Stelle von ‘zw’.</p>
<p class="attribution">—prepare4cbgm_7.py</p>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-scripts.cceh.cbgm">
<span id="scripts-cceh-cbgm"></span><h2>scripts.cceh.cbgm<a class="headerlink" href="#module-scripts.cceh.cbgm" title="Permalink to this headline">¶</a></h2>
<p>Perform the CBGM.</p>
<p>This script</p>
<ul class="simple">
<li><p>rebuilds the ‘A’ text from the local stemmas,</p></li>
<li><p>calculates the pre-coherence similarity of manuscripts, and</p></li>
<li><p>calculates the post-coherence ancestrality of manuscripts.</p></li>
</ul>
<p>This script updates the tables shown in red in the <a class="reference internal" href="database.html#db-overwiew"><span class="std std-ref">overview</span></a>.
It also updates the Apparatus table where manuscript ‘A is concerned.</p>
<dl class="function">
<dt id="scripts.cceh.cbgm.build_A_text">
<code class="sig-name descname">build_A_text</code><span class="sig-paren">(</span><em class="sig-param">dba</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#scripts.cceh.cbgm.build_A_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the ‘A’ text</p>
<p>The editors’ reconstruction of the archetype is recorded in the locstem
table. This functions generates a virtual manuscript ‘A’ from those choices.</p>
<p>The designation of a passage as ‘Fehlvers’ is an editorial decision that the
verse is not original, so we set ‘zu’.</p>
<p>If the editors came to no final decision, no ‘original’ reading will be
found in locstem.  In this case we set ‘A’ to ‘zz’ and there will be a gap
in the reconstructed text.</p>
<p>The Lesart of ‘A’ is always NULL, because it is a virtual manuscript.</p>
</dd></dl>

</div>
<div class="section" id="module-scripts.cceh.save_edits">
<span id="scripts-cceh-save-edits"></span><h2>scripts.cceh.save_edits<a class="headerlink" href="#module-scripts.cceh.save_edits" title="Permalink to this headline">¶</a></h2>
<p>Save the state of the editor tables.</p>
<p>This script saves the tables containing the editorial decisions.  It does not
save the apparatus tables.</p>
</div>
<div class="section" id="module-scripts.cceh.load_edits">
<span id="scripts-cceh-load-edits"></span><h2>scripts.cceh.load_edits<a class="headerlink" href="#module-scripts.cceh.load_edits" title="Permalink to this headline">¶</a></h2>
<p>Load a saved state of the editor tables.</p>
<p>This script loads the state of the tables with the editorial decisions as saved
by the save_edits.py script.  It does not touch the apparatus tables.</p>
<p>While loading, it checks for errors and discrepancies, eg. different passage
addresses.  Passages in the apparatus that are not in the save state are reset
to the default of: reading ‘a’ is original and every other reading is derived
from ‘a’.</p>
</div>
<div class="section" id="module-scripts.cceh.mk_users">
<span id="scripts-cceh-mk-users"></span><h2>scripts.cceh.mk_users<a class="headerlink" href="#module-scripts.cceh.mk_users" title="Permalink to this headline">¶</a></h2>
<p>Initialize the database for user authentication and authorization.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="database.html" class="btn btn-neutral float-right" title="Database Structure" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="server_dev.html" class="btn btn-neutral float-left" title="API Server" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-19 CCeH - Licensed under the GNU GPL v3 or later

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>